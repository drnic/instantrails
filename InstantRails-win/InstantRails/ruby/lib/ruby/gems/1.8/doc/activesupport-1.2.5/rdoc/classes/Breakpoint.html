<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: Breakpoint</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">Breakpoint</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/lib/active_support/breakpoint_rb.html">
                lib/active_support/breakpoint.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000316">activate_drb</a>&nbsp;&nbsp;
      <a href="#M000315">assert</a>&nbsp;&nbsp;
      <a href="#M000314">breakpoint</a>&nbsp;&nbsp;
      <a href="#M000317">deactivate_drb</a>&nbsp;&nbsp;
      <a href="#M000318">use_drb?</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">


    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">Version</td>
          <td>=</td>
          <td class="context-item-value">id.split(&quot; &quot;)[2].to_i</td>
        </tr>
        </table>
      </div>
    </div>



    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">asserts_cause_exceptions</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Whether an Exception should be raised on failed asserts in non-$DEBUG code
or not. By default this is disabled.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">optimize_asserts</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Whether asserts should be ignored if not in debug mode. Debug mode can be
enabled by running ruby with the -d switch or by setting $DEBUG to true.

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000316" class="method-detail">
        <a name="M000316"></a>

        <div class="method-heading">
          <a href="Breakpoint.src/M000316.html" target="Code" class="method-signature"
            onclick="popupCode('Breakpoint.src/M000316.html');return false;">
          <span class="method-name">activate_drb</span><span class="method-args">(uri = nil, allowed_hosts = ['localhost', '127.0.0.1', '::1'], ignore_collisions = false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Will run <a href="Breakpoint.html">Breakpoint</a> in DRb mode. This will
spawn a server that can be attached to via the breakpoint-client command
whenever a breakpoint is executed. This is useful when you are debugging
CGI applications or other applications where you can&#8217;t access debug
sessions via the standard input and output of your application.
</p>
<p>
You can specify an URI where the DRb server will run at. This way you can
specify the port the server runs on. The default URI is
druby://localhost:42531.
</p>
<p>
Please note that breakpoints will be skipped silently in case the DRb
server can not spawned. (This can happen if the port is already used by
another instance of your application on CGI or another application.)
</p>
<p>
Also note that by default this will only allow access from localhost. You
can however specify a list of allowed hosts or nil (to allow access from
everywhere). But that will still not protect you from somebody reading the
data as it goes through the net.
</p>
<p>
A good approach for getting security and remote access is setting up an SSH
tunnel between the DRb service and the client. This is usually done like
this:
</p>
<p>
$ ssh -L20000:127.0.0.1:20000 -R10000:127.0.0.1:10000 example.com (This
will connect port 20000 at the client side to port 20000 at the server
side, and port 10000 at the server side to port 10000 at the client side.)
</p>
<p>
After that do this on the server side: (the code being debugged) <a
href="Breakpoint.html#M000316">Breakpoint.activate_drb</a>(&quot;druby://127.0.0.1:20000&quot;,
&quot;localhost&quot;)
</p>
<p>
And at the client side: ruby breakpoint_client.rb -c
druby://127.0.0.1:10000 -s druby://127.0.0.1:20000
</p>
<p>
Running through such a SSH proxy will also let you use breakpoint.rb in
case you are behind a firewall.
</p>
<p>
Detailed information about running DRb through firewalls is available at <a
href="http://www.rubygarden.org/ruby?DrbTutorial">www.rubygarden.org/ruby?DrbTutorial</a>
</p>
        </div>
      </div>

      <div id="method-M000315" class="method-detail">
        <a name="M000315"></a>

        <div class="method-heading">
          <a href="Breakpoint.src/M000315.html" target="Code" class="method-signature"
            onclick="popupCode('Breakpoint.src/M000315.html');return false;">
          <span class="method-name">assert</span><span class="method-args">(context = nil) {|| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This asserts that the block evaluates to true. If it doesn&#8217;t evaluate
to true a breakpoint will automatically be created at that execution point.
</p>
<p>
You can disable assert checking in production code by setting
Breakpoint.optimize_asserts to true. (It will still be enabled when Ruby is
run via the -d argument.)
</p>
<p>
Example:
</p>
<pre>
  person_name = &quot;Foobar&quot;
  assert { not person_name.nil? }
</pre>
<p>
Note: If you want to use this method from an unit test, you will have to
call it by its full name, <a
href="Breakpoint.html#M000315">Breakpoint.assert</a>.
</p>
        </div>
      </div>

      <div id="method-M000314" class="method-detail">
        <a name="M000314"></a>

        <div class="method-heading">
          <a href="Breakpoint.src/M000314.html" target="Code" class="method-signature"
            onclick="popupCode('Breakpoint.src/M000314.html');return false;">
          <span class="method-name">breakpoint</span><span class="method-args">(id = nil, context = nil, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This will pop up an interactive ruby session at a pre-defined break point
in a Ruby application. In this session you can examine the environment of
the break point.
</p>
<p>
You can get a list of variables in the context using local_variables via
<tt>local_variables</tt>. You can then examine their values by typing their
names.
</p>
<p>
You can have a look at the call stack via <tt>caller</tt>.
</p>
<p>
The source code around the location where the breakpoint was executed can
be examined via <tt>source_lines</tt>. Its argument specifies how much
lines of context to display. The default amount of context is 5 lines. Note
that the call to <tt>source_lines</tt> can raise an exception when it
isn&#8217;t able to read in the source code.
</p>
<p>
breakpoints can also return a value. They will execute a supplied block for
getting a default return value. A custom value can be returned from the
session by doing +throw(:debug_return, value)+.
</p>
<p>
You can also give names to break points which will be used in the message
that is displayed upon execution of them.
</p>
<p>
Here&#8217;s a sample of how breakpoints should be placed:
</p>
<pre>
  class Person
    def initialize(name, age)
      @name, @age = name, age
      breakpoint(&quot;Person#initialize&quot;)
    end

    attr_reader :age
    def name
      breakpoint(&quot;Person#name&quot;) { @name }
    end
  end

  person = Person.new(&quot;Random Person&quot;, 23)
  puts &quot;Name: #{person.name}&quot;
</pre>
<p>
And here is a sample debug session:
</p>
<pre>
  Executing break point &quot;Person#initialize&quot; at file.rb:4 in `initialize'
  irb(#&lt;Person:0x292fbe8&gt;):001:0&gt; local_variables
  =&gt; [&quot;name&quot;, &quot;age&quot;, &quot;_&quot;, &quot;__&quot;]
  irb(#&lt;Person:0x292fbe8&gt;):002:0&gt; [name, age]
  =&gt; [&quot;Random Person&quot;, 23]
  irb(#&lt;Person:0x292fbe8&gt;):003:0&gt; [@name, @age]
  =&gt; [&quot;Random Person&quot;, 23]
  irb(#&lt;Person:0x292fbe8&gt;):004:0&gt; self
  =&gt; #&lt;Person:0x292fbe8 @age=23, @name=&quot;Random Person&quot;&gt;
  irb(#&lt;Person:0x292fbe8&gt;):005:0&gt; @age += 1; self
  =&gt; #&lt;Person:0x292fbe8 @age=24, @name=&quot;Random Person&quot;&gt;
  irb(#&lt;Person:0x292fbe8&gt;):006:0&gt; exit
  Executing break point &quot;Person#name&quot; at file.rb:9 in `name'
  irb(#&lt;Person:0x292fbe8&gt;):001:0&gt; throw(:debug_return, &quot;Overriden name&quot;)
  Name: Overriden name
</pre>
<p>
<a href="Breakpoint.html">Breakpoint</a> sessions will automatically have a
few convenience methods available. See Breakpoint::CommandBundle for a list
of them.
</p>
<p>
Breakpoints can also be used remotely over sockets. This is implemented by
running part of the IRB session in the application and part of it in a
special client. You have to call <a
href="Breakpoint.html#M000316">Breakpoint.activate_drb</a> to enable
support for remote breakpoints and then run breakpoint_client.rb which is
distributed with this library. See the documentation of <a
href="Breakpoint.html#M000316">Breakpoint.activate_drb</a> for details.
</p>
        </div>
      </div>

      <div id="method-M000317" class="method-detail">
        <a name="M000317"></a>

        <div class="method-heading">
          <a href="Breakpoint.src/M000317.html" target="Code" class="method-signature"
            onclick="popupCode('Breakpoint.src/M000317.html');return false;">
          <span class="method-name">deactivate_drb</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Deactivates a running <a href="Breakpoint.html">Breakpoint</a> service.
</p>
        </div>
      </div>

      <div id="method-M000318" class="method-detail">
        <a name="M000318"></a>

        <div class="method-heading">
          <a href="Breakpoint.src/M000318.html" target="Code" class="method-signature"
            onclick="popupCode('Breakpoint.src/M000318.html');return false;">
          <span class="method-name">use_drb?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true when Breakpoints are used over DRb. <a
href="Breakpoint.html#M000316">Breakpoint.activate_drb</a> causes this to
be true.
</p>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>