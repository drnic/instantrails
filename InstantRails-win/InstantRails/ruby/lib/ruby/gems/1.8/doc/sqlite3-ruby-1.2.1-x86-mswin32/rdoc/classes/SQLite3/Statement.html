<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: SQLite3::Statement</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">SQLite3::Statement</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/sqlite3/statement_rb.html">
                lib/sqlite3/statement.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
A statement represents a prepared-but-unexecuted SQL query. It will rarely
(if ever) be instantiated directly by a client, and is most often obtained
via the <a href="Database.html#M000104">Database#prepare</a> method.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000082">active?</a>&nbsp;&nbsp;
      <a href="#M000078">bind_param</a>&nbsp;&nbsp;
      <a href="#M000077">bind_params</a>&nbsp;&nbsp;
      <a href="#M000075">close</a>&nbsp;&nbsp;
      <a href="#M000076">closed?</a>&nbsp;&nbsp;
      <a href="#M000083">columns</a>&nbsp;&nbsp;
      <a href="#M000079">execute</a>&nbsp;&nbsp;
      <a href="#M000080">execute!</a>&nbsp;&nbsp;
      <a href="#M000074">new</a>&nbsp;&nbsp;
      <a href="#M000081">reset!</a>&nbsp;&nbsp;
      <a href="#M000084">types</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">handle</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The underlying opaque handle used to access the SQLite @driver.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">remainder</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
This is any text that followed the first valid SQL statement in the text
with which the statement was initialized. If there was no trailing text,
this will be the empty string.

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000074" class="method-detail">
        <a name="M000074"></a>

        <div class="method-heading">
          <a href="Statement.src/M000074.html" target="Code" class="method-signature"
            onclick="popupCode('Statement.src/M000074.html');return false;">
          <span class="method-name">new</span><span class="method-args">( db, sql, utf16=false )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Create a <a href="Statement.html#M000074">new</a> statement attached to the
given <a href="Database.html">Database</a> instance, and which encapsulates
the given SQL text. If the text contains more than one statement (i.e.,
separated by semicolons), then the remainder property will be set to the
trailing text.
</p>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000082" class="method-detail">
        <a name="M000082"></a>

        <div class="method-heading">
          <a href="Statement.src/M000082.html" target="Code" class="method-signature"
            onclick="popupCode('Statement.src/M000082.html');return false;">
          <span class="method-name">active?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if the statement is currently active, meaning it has an open
result set.
</p>
        </div>
      </div>

      <div id="method-M000078" class="method-detail">
        <a name="M000078"></a>

        <div class="method-heading">
          <a href="Statement.src/M000078.html" target="Code" class="method-signature"
            onclick="popupCode('Statement.src/M000078.html');return false;">
          <span class="method-name">bind_param</span><span class="method-args">( param, value )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Binds value to the named (or positional) placeholder. If <tt>param</tt> is
a Fixnum, it is treated as an index for a positional placeholder. Otherwise
it is used as the name of the placeholder to bind to.
</p>
<p>
See also <a href="Statement.html#M000077">bind_params</a>.
</p>
        </div>
      </div>

      <div id="method-M000077" class="method-detail">
        <a name="M000077"></a>

        <div class="method-heading">
          <a href="Statement.src/M000077.html" target="Code" class="method-signature"
            onclick="popupCode('Statement.src/M000077.html');return false;">
          <span class="method-name">bind_params</span><span class="method-args">( *bind_vars )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Binds the given variables to the corresponding placeholders in the SQL
text.
</p>
<p>
See <a href="Database.html#M000105">Database#execute</a> for a description
of the valid placeholder syntaxes.
</p>
<p>
Example:
</p>
<pre>
  stmt = db.prepare( &quot;select * from table where a=? and b=?&quot; )
  stmt.bind_params( 15, &quot;hello&quot; )
</pre>
<p>
See also <a href="Statement.html#M000079">execute</a>, <a
href="Statement.html#M000078">bind_param</a>, <a
href="Statement.html#M000078">Statement#bind_param</a>, and <a
href="Statement.html#M000077">Statement#bind_params</a>.
</p>
        </div>
      </div>

      <div id="method-M000075" class="method-detail">
        <a name="M000075"></a>

        <div class="method-heading">
          <a href="Statement.src/M000075.html" target="Code" class="method-signature"
            onclick="popupCode('Statement.src/M000075.html');return false;">
          <span class="method-name">close</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Closes the statement by finalizing the underlying statement handle. The
statement must not be used after being closed.
</p>
        </div>
      </div>

      <div id="method-M000076" class="method-detail">
        <a name="M000076"></a>

        <div class="method-heading">
          <a href="Statement.src/M000076.html" target="Code" class="method-signature"
            onclick="popupCode('Statement.src/M000076.html');return false;">
          <span class="method-name">closed?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if the underlying statement has been closed.
</p>
        </div>
      </div>

      <div id="method-M000083" class="method-detail">
        <a name="M000083"></a>

        <div class="method-heading">
          <a href="Statement.src/M000083.html" target="Code" class="method-signature"
            onclick="popupCode('Statement.src/M000083.html');return false;">
          <span class="method-name">columns</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return an array of the column names for this statement. Note that this may
<a href="Statement.html#M000079">execute</a> the statement in order to
obtain the metadata; this makes it a (potentially) expensive operation.
</p>
        </div>
      </div>

      <div id="method-M000079" class="method-detail">
        <a name="M000079"></a>

        <div class="method-heading">
          <a href="Statement.src/M000079.html" target="Code" class="method-signature"
            onclick="popupCode('Statement.src/M000079.html');return false;">
          <span class="method-name">execute</span><span class="method-args">( *bind_vars ) {|@results| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Execute the statement. This creates a <a
href="Statement.html#M000074">new</a> <a
href="ResultSet.html">ResultSet</a> object for the statement&#8216;s
virtual machine. If a block was given, the <a
href="Statement.html#M000074">new</a> <a
href="ResultSet.html">ResultSet</a> will be yielded to it; otherwise, the
<a href="ResultSet.html">ResultSet</a> will be returned.
</p>
<p>
Any parameters will be bound to the statement using <a
href="Statement.html#M000077">bind_params</a>.
</p>
<p>
Example:
</p>
<pre>
  stmt = db.prepare( &quot;select * from table&quot; )
  stmt.execute do |result|
    ...
  end
</pre>
<p>
See also <a href="Statement.html#M000077">bind_params</a>, <a
href="Statement.html#M000079">execute</a>!.
</p>
        </div>
      </div>

      <div id="method-M000080" class="method-detail">
        <a name="M000080"></a>

        <div class="method-heading">
          <a href="Statement.src/M000080.html" target="Code" class="method-signature"
            onclick="popupCode('Statement.src/M000080.html');return false;">
          <span class="method-name">execute!</span><span class="method-args">( *bind_vars ) {|row| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Execute the statement. If no block was given, this returns an array of rows
returned by executing the statement. Otherwise, each row will be yielded to
the block.
</p>
<p>
Any parameters will be bound to the statement using <a
href="Statement.html#M000077">bind_params</a>.
</p>
<p>
Example:
</p>
<pre>
  stmt = db.prepare( &quot;select * from table&quot; )
  stmt.execute! do |row|
    ...
  end
</pre>
<p>
See also <a href="Statement.html#M000077">bind_params</a>, <a
href="Statement.html#M000079">execute</a>.
</p>
        </div>
      </div>

      <div id="method-M000081" class="method-detail">
        <a name="M000081"></a>

        <div class="method-heading">
          <a href="Statement.src/M000081.html" target="Code" class="method-signature"
            onclick="popupCode('Statement.src/M000081.html');return false;">
          <span class="method-name">reset!</span><span class="method-args">(clear_result=true)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Resets the statement. This is typically done internally, though it might
occassionally be necessary to manually reset the statement.
</p>
        </div>
      </div>

      <div id="method-M000084" class="method-detail">
        <a name="M000084"></a>

        <div class="method-heading">
          <a href="Statement.src/M000084.html" target="Code" class="method-signature"
            onclick="popupCode('Statement.src/M000084.html');return false;">
          <span class="method-name">types</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return an array of the data <a href="Statement.html#M000084">types</a> for
each column in this statement. Note that this may <a
href="Statement.html#M000079">execute</a> the statement in order to obtain
the metadata; this makes it a (potentially) expensive operation.
</p>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>