<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>File: multipart_progress.rb</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



  <div id="fileHeader">
    <h1>multipart_progress.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>lib/action_controller/cgi_ext/multipart_progress.rb
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Wed Dec 14 15:42:22 Central Standard Time 2005</td>
    </tr>
    </table>
  </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <h2>Overview</h2>
<p>
This module will extend the CGI module with methods to track the upload
progress for multipart forms for use with progress meters. The progress is
saved in the session to be used from any request from any server with the
same session. In other words, this module will work across application
instances.
</p>
<h3>Usage</h3>
<p>
Just do your file-uploads as you normally would, but include an upload_id
in the query string of your form action. Your form post action should look
like:
</p>
<pre>
  &lt;form method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; action=&quot;postaction?upload_id=SOMEIDYOUSET&quot;&gt;
    &lt;input type=&quot;file&quot; name=&quot;client_file&quot;/&gt;
  &lt;/form&gt;
</pre>
<p>
Query the upload state in a progress by reading the progress from the
session
</p>
<pre>
  class UploadController &lt; ApplicationController
    def upload_status
      render :text =&gt; &quot;Percent complete: &quot; + @session[:uploads]['SOMEIDYOUSET'].completed_percent&quot;
    end
  end
</pre>
<h3>Session options</h3>
<p>
Upload progress uses the session options defined in
ActionController::CgiRequest::DEFAULT_SESSION_OPTIONS. If you are passing
custom session options to your dispatcher then please follow the
&quot;recommended way to change session options&quot;:<a
href="http://wiki.rubyonrails.com/rails/show/HowtoChangeSessionOptions">wiki.rubyonrails.com/rails/show/HowtoChangeSessionOptions</a>
</p>
<h3>Update frequency</h3>
<p>
During an upload, the progress will be written to the session every 2
seconds. This prevents excessive writes yet maintains a decent picture of
the upload progress for larger files.
</p>
<p>
User interfaces that update more often that every 2 seconds will display
the same results. Consider this update frequency when designing your
progress polling.
</p>

    </div>

    <div id="requires-list">
      <h3 class="section-bar">Required files</h3>

      <div class="name-list">
      cgi&nbsp;&nbsp;
      action_controller/base&nbsp;&nbsp;
      action_controller/cgi_process&nbsp;&nbsp;
      action_controller/upload_progress&nbsp;&nbsp;
      </div>
    </div>

   </div>


  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>