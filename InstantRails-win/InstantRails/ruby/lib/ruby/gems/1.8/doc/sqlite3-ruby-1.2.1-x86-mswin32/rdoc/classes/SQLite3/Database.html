<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: SQLite3::Database</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">SQLite3::Database</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/sqlite3/database_rb.html">
                lib/sqlite3/database.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
The <a href="Database.html">Database</a> class encapsulates a single
connection to a <a href="../SQLite3.html">SQLite3</a> database. Its usage
is very straightforward:
</p>
<pre>
  require 'sqlite3'

  db = SQLite3::Database.new( &quot;data.db&quot; )

  db.execute( &quot;select * from table&quot; ) do |row|
    p row
  end

  db.close
</pre>
<p>
It wraps the lower-level methods provides by the selected driver, and
includes the <a href="Pragmas.html">Pragmas</a> module for access to
various pragma convenience methods.
</p>
<p>
The <a href="Database.html">Database</a> class provides type translation
services as well, by which the <a href="../SQLite3.html">SQLite3</a> data
types (which are all represented as strings) may be converted into their
corresponding types (as defined in the schemas for their tables). This
translation only occurs when querying data from the
database&#8212;insertions and updates are all still typeless.
</p>
<p>
Furthermore, the <a href="Database.html">Database</a> class has been
designed to work well with the ArrayFields module from Ara Howard. If you
require the ArrayFields module before performing a <a
href="Database.html#M000108">query</a>, and if you have not enabled results
as hashes, then the results will all be indexible by field name.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000103">authorizer</a>&nbsp;&nbsp;
      <a href="#M000115">busy_handler</a>&nbsp;&nbsp;
      <a href="#M000116">busy_timeout</a>&nbsp;&nbsp;
      <a href="#M000112">changes</a>&nbsp;&nbsp;
      <a href="#M000100">close</a>&nbsp;&nbsp;
      <a href="#M000101">closed?</a>&nbsp;&nbsp;
      <a href="#M000121">commit</a>&nbsp;&nbsp;
      <a href="#M000096">complete?</a>&nbsp;&nbsp;
      <a href="#M000118">create_aggregate</a>&nbsp;&nbsp;
      <a href="#M000119">create_aggregate_handler</a>&nbsp;&nbsp;
      <a href="#M000117">create_function</a>&nbsp;&nbsp;
      <a href="#M000098">errcode</a>&nbsp;&nbsp;
      <a href="#M000097">errmsg</a>&nbsp;&nbsp;
      <a href="#M000105">execute</a>&nbsp;&nbsp;
      <a href="#M000106">execute2</a>&nbsp;&nbsp;
      <a href="#M000107">execute_batch</a>&nbsp;&nbsp;
      <a href="#M000109">get_first_row</a>&nbsp;&nbsp;
      <a href="#M000110">get_first_value</a>&nbsp;&nbsp;
      <a href="#M000114">interrupt</a>&nbsp;&nbsp;
      <a href="#M000111">last_insert_row_id</a>&nbsp;&nbsp;
      <a href="#M000095">new</a>&nbsp;&nbsp;
      <a href="#M000104">prepare</a>&nbsp;&nbsp;
      <a href="#M000108">query</a>&nbsp;&nbsp;
      <a href="#M000094">quote</a>&nbsp;&nbsp;
      <a href="#M000122">rollback</a>&nbsp;&nbsp;
      <a href="#M000113">total_changes</a>&nbsp;&nbsp;
      <a href="#M000102">trace</a>&nbsp;&nbsp;
      <a href="#M000120">transaction</a>&nbsp;&nbsp;
      <a href="#M000123">transaction_active?</a>&nbsp;&nbsp;
      <a href="#M000099">translator</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="Pragmas.html">Pragmas</a></span>
      </div>
    </div>

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Class <a href="Database/FunctionProxy.html" class="link">SQLite3::Database::FunctionProxy</a><br />

    </div>


    <div id="aliases-list">
      <h3 class="section-bar">External Aliases</h3>

      <div class="name-list">
                        <table summary="aliases">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">new</td>
          <td>-&gt;</td>
          <td class="context-item-value">open</td>
        </tr>
                        </table>
      </div>
    </div>


    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">driver</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
A reference to the underlying <a href="../SQLite3.html">SQLite3</a> driver
used by this database.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">handle</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The low-level opaque database handle that this object wraps.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">results_as_hash</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
A boolean that indicates whether rows in result sets should be returned as
hashes or not. By default, rows are returned as arrays.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">type_translation</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
A boolean indicating whether or not type translation is enabled for this
database.

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000095" class="method-detail">
        <a name="M000095"></a>

        <div class="method-heading">
          <a href="Database.src/M000095.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000095.html');return false;">
          <span class="method-name">new</span><span class="method-args">( file_name, options={} )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Create a <a href="Database.html#M000095">new</a> <a
href="Database.html">Database</a> object that opens the given file. If
utf16 is <tt>true</tt>, the filename is interpreted as a UTF-16 encoded
string.
</p>
<p>
By default, the <a href="Database.html#M000095">new</a> database will
return result rows as arrays (results_as_hash) and has type translation
disabled (type_translation=).
</p>
        </div>
      </div>

      <div id="method-M000094" class="method-detail">
        <a name="M000094"></a>

        <div class="method-heading">
          <a href="Database.src/M000094.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000094.html');return false;">
          <span class="method-name">quote</span><span class="method-args">( string )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Quotes the given string, making it safe to use in an SQL statement. It
replaces all instances of the single-<a
href="Database.html#M000094">quote</a> character with two single-<a
href="Database.html#M000094">quote</a> characters. The modified string is
returned.
</p>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000103" class="method-detail">
        <a name="M000103"></a>

        <div class="method-heading">
          <a href="Database.src/M000103.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000103.html');return false;">
          <span class="method-name">authorizer</span><span class="method-args">( data=nil, &amp;block )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Installs (or removes) a block that will be invoked for every access to the
database. If the block returns 0 (or <tt>nil</tt>), the statement is
allowed to proceed. Returning 1 causes an authorization error to occur, and
returning 2 causes the access to be silently denied.
</p>
        </div>
      </div>

      <div id="method-M000115" class="method-detail">
        <a name="M000115"></a>

        <div class="method-heading">
          <a href="Database.src/M000115.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000115.html');return false;">
          <span class="method-name">busy_handler</span><span class="method-args">( data=nil ) {|data, retries| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Register a busy handler with this database instance. When a requested
resource is busy, this handler will be invoked. If the handler returns
<tt>false</tt>, the operation will be aborted; otherwise, the resource will
be requested again.
</p>
<p>
The handler will be invoked with the name of the resource that was busy,
and the number of times it has been retried.
</p>
<p>
See also <a href="Database.html#M000116">busy_timeout</a>.
</p>
        </div>
      </div>

      <div id="method-M000116" class="method-detail">
        <a name="M000116"></a>

        <div class="method-heading">
          <a href="Database.src/M000116.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000116.html');return false;">
          <span class="method-name">busy_timeout</span><span class="method-args">( ms )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Indicates that if a request for a resource terminates because that resource
is busy, SQLite should wait for the indicated number of milliseconds before
trying again. By default, SQLite does not retry busy resources. To restore
the default behavior, send 0 as the <tt>ms</tt> parameter.
</p>
<p>
See also <a href="Database.html#M000115">busy_handler</a>.
</p>
        </div>
      </div>

      <div id="method-M000112" class="method-detail">
        <a name="M000112"></a>

        <div class="method-heading">
          <a href="Database.src/M000112.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000112.html');return false;">
          <span class="method-name">changes</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the number of <a href="Database.html#M000112">changes</a> made to
this database instance by the last operation performed. Note that a
&quot;delete from table&quot; without a where clause will not affect this
value.
</p>
        </div>
      </div>

      <div id="method-M000100" class="method-detail">
        <a name="M000100"></a>

        <div class="method-heading">
          <a href="Database.src/M000100.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000100.html');return false;">
          <span class="method-name">close</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Closes this database.
</p>
        </div>
      </div>

      <div id="method-M000101" class="method-detail">
        <a name="M000101"></a>

        <div class="method-heading">
          <a href="Database.src/M000101.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000101.html');return false;">
          <span class="method-name">closed?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns <tt>true</tt> if this database instance has been closed (see <a
href="Database.html#M000100">close</a>).
</p>
        </div>
      </div>

      <div id="method-M000121" class="method-detail">
        <a name="M000121"></a>

        <div class="method-heading">
          <a href="Database.src/M000121.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000121.html');return false;">
          <span class="method-name">commit</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Commits the current <a href="Database.html#M000120">transaction</a>. If
there is no current <a href="Database.html#M000120">transaction</a>, this
will cause an error to be raised. This returns <tt>true</tt>, in order to
allow it to be used in idioms like <tt>abort? and <a
href="Database.html#M000122">rollback</a> or <a
href="Database.html#M000121">commit</a></tt>.
</p>
        </div>
      </div>

      <div id="method-M000096" class="method-detail">
        <a name="M000096"></a>

        <div class="method-heading">
          <a href="Database.src/M000096.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000096.html');return false;">
          <span class="method-name">complete?</span><span class="method-args">( string, utf16=false )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return <tt>true</tt> if the string is a valid (ie, parsable) SQL statement,
and <tt>false</tt> otherwise. If +utf16+ is <tt>true</tt>, then the string
is a UTF-16 character string.
</p>
        </div>
      </div>

      <div id="method-M000118" class="method-detail">
        <a name="M000118"></a>

        <div class="method-heading">
          <a href="Database.src/M000118.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000118.html');return false;">
          <span class="method-name">create_aggregate</span><span class="method-args">( name, arity, step=nil, finalize=nil, text_rep=Constants::TextRep::ANY, &amp;block )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates a <a href="Database.html#M000095">new</a> aggregate function for
use in SQL statements. Aggregate functions are functions that apply over
every row in the result set, instead of over just a single row. (A very
common aggregate function is the &quot;count&quot; function, for
determining the number of rows that match a <a
href="Database.html#M000108">query</a>.)
</p>
<p>
The <a href="Database.html#M000095">new</a> function will be added as
<tt>name</tt>, with the given <tt>arity</tt>. (For variable arity
functions, use -1 for the arity.)
</p>
<p>
The <tt>step</tt> parameter must be a proc object that accepts as its first
parameter a <a href="Database/FunctionProxy.html">FunctionProxy</a>
instance (representing the function invocation), with any subsequent
parameters (up to the function&#8216;s arity). The <tt>step</tt> callback
will be invoked once for each row of the result set.
</p>
<p>
The <tt>finalize</tt> parameter must be a <tt>proc</tt> object that accepts
only a single parameter, the <a
href="Database/FunctionProxy.html">FunctionProxy</a> instance representing
the current function invocation. It should invoke <a
href="Database/FunctionProxy.html#M000126">FunctionProxy#set_result</a> to
store the result of the function.
</p>
<p>
Example:
</p>
<pre>
  db.create_aggregate( &quot;lengths&quot;, 1 ) do
    step do |func, value|
      func[ :total ] ||= 0
      func[ :total ] += ( value ? value.length : 0 )
    end

    finalize do |func|
      func.set_result( func[ :total ] || 0 )
    end
  end

  puts db.get_first_value( &quot;select lengths(name) from table&quot; )
</pre>
<p>
See also <a href="Database.html#M000119">create_aggregate_handler</a> for a
more object-oriented approach to aggregate functions.
</p>
        </div>
      </div>

      <div id="method-M000119" class="method-detail">
        <a name="M000119"></a>

        <div class="method-heading">
          <a href="Database.src/M000119.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000119.html');return false;">
          <span class="method-name">create_aggregate_handler</span><span class="method-args">( handler )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This is another approach to creating an aggregate function (see <a
href="Database.html#M000118">create_aggregate</a>). Instead of explicitly
specifying the name, callbacks, arity, and type, you specify a factory
object (the &quot;handler&quot;) that knows how to obtain all of that
information. The handler should respond to the following messages:
</p>
<table>
<tr><td valign="top"><tt>arity</tt>:</td><td>corresponds to the <tt>arity</tt> parameter of <a
href="Database.html#M000118">create_aggregate</a>. This message is
optional, and if the handler does not respond to it, the function will have
an arity of -1.

</td></tr>
<tr><td valign="top"><tt>name</tt>:</td><td>this is the name of the function. The handler <em>must</em> implement this
message.

</td></tr>
<tr><td valign="top"><tt><a href="Database.html#M000095">new</a></tt>:</td><td>this must be implemented by the handler. It should return a <a
href="Database.html#M000095">new</a> instance of the object that will
handle a specific invocation of the function.

</td></tr>
</table>
<p>
The handler instance (the object returned by the <tt><a
href="Database.html#M000095">new</a></tt> message, described above), must
respond to the following messages:
</p>
<table>
<tr><td valign="top"><tt>step</tt>:</td><td>this is the method that will be called for each step of the aggregate
function&#8216;s evaluation. It should implement the same signature as the
<tt>step</tt> callback for <a
href="Database.html#M000118">create_aggregate</a>.

</td></tr>
<tr><td valign="top"><tt>finalize</tt>:</td><td>this is the method that will be called to finalize the aggregate
function&#8216;s evaluation. It should implement the same signature as the
<tt>finalize</tt> callback for <a
href="Database.html#M000118">create_aggregate</a>.

</td></tr>
</table>
<p>
Example:
</p>
<pre>
  class LengthsAggregateHandler
    def self.arity; 1; end

    def initialize
      @total = 0
    end

    def step( ctx, name )
      @total += ( name ? name.length : 0 )
    end

    def finalize( ctx )
      ctx.set_result( @total )
    end
  end

  db.create_aggregate_handler( LengthsAggregateHandler )
  puts db.get_first_value( &quot;select lengths(name) from A&quot; )
</pre>
        </div>
      </div>

      <div id="method-M000117" class="method-detail">
        <a name="M000117"></a>

        <div class="method-heading">
          <a href="Database.src/M000117.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000117.html');return false;">
          <span class="method-name">create_function</span><span class="method-args">( name, arity, text_rep=Constants::TextRep::ANY ) {|func, *args| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates a <a href="Database.html#M000095">new</a> function for use in SQL
statements. It will be added as <tt>name</tt>, with the given
<tt>arity</tt>. (For variable arity functions, use -1 for the arity.)
</p>
<p>
The block should accept at least one parameter&#8212;the <a
href="Database/FunctionProxy.html">FunctionProxy</a> instance that wraps
this function invocation&#8212;and any other arguments it needs (up to its
arity).
</p>
<p>
The block does not return a value directly. Instead, it will invoke the <a
href="Database/FunctionProxy.html#M000126">FunctionProxy#set_result</a>
method on the <tt>func</tt> parameter and indicate the return value that
way.
</p>
<p>
Example:
</p>
<pre>
  db.create_function( &quot;maim&quot;, 1 ) do |func, value|
    if value.nil?
      func.result = nil
    else
      func.result = value.split(//).sort.join
    end
  end

  puts db.get_first_value( &quot;select maim(name) from table&quot; )
</pre>
        </div>
      </div>

      <div id="method-M000098" class="method-detail">
        <a name="M000098"></a>

        <div class="method-heading">
          <a href="Database.src/M000098.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000098.html');return false;">
          <span class="method-name">errcode</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return an integer representing the last error to have occurred with this
database.
</p>
        </div>
      </div>

      <div id="method-M000097" class="method-detail">
        <a name="M000097"></a>

        <div class="method-heading">
          <a href="Database.src/M000097.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000097.html');return false;">
          <span class="method-name">errmsg</span><span class="method-args">( utf16=false )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return a string describing the last error to have occurred with this
database.
</p>
        </div>
      </div>

      <div id="method-M000105" class="method-detail">
        <a name="M000105"></a>

        <div class="method-heading">
          <a href="Database.src/M000105.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000105.html');return false;">
          <span class="method-name">execute</span><span class="method-args">( sql, *bind_vars ) {|row| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Executes the given SQL statement. If additional parameters are given, they
are treated as bind variables, and are bound to the placeholders in the <a
href="Database.html#M000108">query</a>.
</p>
<p>
Note that if any of the values passed to this are hashes, then the
key/value pairs are each bound separately, with the key being used as the
name of the placeholder to bind the value to.
</p>
<p>
The block is optional. If given, it will be invoked for each row returned
by the <a href="Database.html#M000108">query</a>. Otherwise, any results
are accumulated into an array and returned wholesale.
</p>
<p>
See also <a href="Database.html#M000106">execute2</a>, <a
href="Database.html#M000108">query</a>, and <a
href="Database.html#M000107">execute_batch</a> for additional ways of
executing statements.
</p>
        </div>
      </div>

      <div id="method-M000106" class="method-detail">
        <a name="M000106"></a>

        <div class="method-heading">
          <a href="Database.src/M000106.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000106.html');return false;">
          <span class="method-name">execute2</span><span class="method-args">( sql, *bind_vars ) {|result.columns| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Executes the given SQL statement, exactly as with <a
href="Database.html#M000105">execute</a>. However, the first row returned
(either via the block, or in the returned array) is always the names of the
columns. Subsequent rows correspond to the data from the result set.
</p>
<p>
Thus, even if the <a href="Database.html#M000108">query</a> itself returns
no rows, this method will always return at least one row&#8212;the names of
the columns.
</p>
<p>
See also <a href="Database.html#M000105">execute</a>, <a
href="Database.html#M000108">query</a>, and <a
href="Database.html#M000107">execute_batch</a> for additional ways of
executing statements.
</p>
        </div>
      </div>

      <div id="method-M000107" class="method-detail">
        <a name="M000107"></a>

        <div class="method-heading">
          <a href="Database.src/M000107.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000107.html');return false;">
          <span class="method-name">execute_batch</span><span class="method-args">( sql, *bind_vars )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Executes all SQL statements in the given string. By contrast, the other
means of executing queries will only <a
href="Database.html#M000105">execute</a> the first statement in the string,
ignoring all subsequent statements. This will <a
href="Database.html#M000105">execute</a> each one in turn. The same bind
parameters, if given, will be applied to each statement.
</p>
<p>
This always returns <tt>nil</tt>, making it unsuitable for queries that
return rows.
</p>
        </div>
      </div>

      <div id="method-M000109" class="method-detail">
        <a name="M000109"></a>

        <div class="method-heading">
          <a href="Database.src/M000109.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000109.html');return false;">
          <span class="method-name">get_first_row</span><span class="method-args">( sql, *bind_vars )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
A convenience method for obtaining the first row of a result set, and
discarding all others. It is otherwise identical to <a
href="Database.html#M000105">execute</a>.
</p>
<p>
See also <a href="Database.html#M000110">get_first_value</a>.
</p>
        </div>
      </div>

      <div id="method-M000110" class="method-detail">
        <a name="M000110"></a>

        <div class="method-heading">
          <a href="Database.src/M000110.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000110.html');return false;">
          <span class="method-name">get_first_value</span><span class="method-args">( sql, *bind_vars )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
A convenience method for obtaining the first value of the first row of a
result set, and discarding all other values and rows. It is otherwise
identical to <a href="Database.html#M000105">execute</a>.
</p>
<p>
See also <a href="Database.html#M000109">get_first_row</a>.
</p>
        </div>
      </div>

      <div id="method-M000114" class="method-detail">
        <a name="M000114"></a>

        <div class="method-heading">
          <a href="Database.src/M000114.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000114.html');return false;">
          <span class="method-name">interrupt</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Interrupts the currently executing operation, causing it to abort.
</p>
        </div>
      </div>

      <div id="method-M000111" class="method-detail">
        <a name="M000111"></a>

        <div class="method-heading">
          <a href="Database.src/M000111.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000111.html');return false;">
          <span class="method-name">last_insert_row_id</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Obtains the unique row ID of the last row to be inserted by this <a
href="Database.html">Database</a> instance.
</p>
        </div>
      </div>

      <div id="method-M000104" class="method-detail">
        <a name="M000104"></a>

        <div class="method-heading">
          <a href="Database.src/M000104.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000104.html');return false;">
          <span class="method-name">prepare</span><span class="method-args">( sql ) {|stmt| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a <a href="Statement.html">Statement</a> object representing the
given SQL. This does not <a href="Database.html#M000105">execute</a> the
statement; it merely prepares the statement for execution.
</p>
        </div>
      </div>

      <div id="method-M000108" class="method-detail">
        <a name="M000108"></a>

        <div class="method-heading">
          <a href="Database.src/M000108.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000108.html');return false;">
          <span class="method-name">query</span><span class="method-args">( sql, *bind_vars ) {|result| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This is a convenience method for creating a statement, binding paramters to
it, and calling <a href="Database.html#M000105">execute</a>:
</p>
<pre>
  result = db.query( &quot;select * from foo where a=?&quot;, 5 )
  # is the same as
  result = db.prepare( &quot;select * from foo where a=?&quot; ).execute( 5 )
</pre>
<p>
You must be sure to call <tt><a href="Database.html#M000100">close</a></tt>
on the <a href="ResultSet.html">ResultSet</a> instance that is returned, or
you could have problems with locks on the table. If called with a block,
<tt><a href="Database.html#M000100">close</a></tt> will be invoked
implicitly when the block terminates.
</p>
        </div>
      </div>

      <div id="method-M000122" class="method-detail">
        <a name="M000122"></a>

        <div class="method-heading">
          <a href="Database.src/M000122.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000122.html');return false;">
          <span class="method-name">rollback</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Rolls the current <a href="Database.html#M000120">transaction</a> back. If
there is no current <a href="Database.html#M000120">transaction</a>, this
will cause an error to be raised. This returns <tt>true</tt>, in order to
allow it to be used in idioms like <tt>abort? and <a
href="Database.html#M000122">rollback</a> or <a
href="Database.html#M000121">commit</a></tt>.
</p>
        </div>
      </div>

      <div id="method-M000113" class="method-detail">
        <a name="M000113"></a>

        <div class="method-heading">
          <a href="Database.src/M000113.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000113.html');return false;">
          <span class="method-name">total_changes</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the total number of <a href="Database.html#M000112">changes</a>
made to this database instance since it was opened.
</p>
        </div>
      </div>

      <div id="method-M000102" class="method-detail">
        <a name="M000102"></a>

        <div class="method-heading">
          <a href="Database.src/M000102.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000102.html');return false;">
          <span class="method-name">trace</span><span class="method-args">( data=nil, &amp;block )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Installs (or removes) a block that will be invoked for every SQL statement
executed. The block receives a two parameters: the <tt>data</tt> argument,
and the SQL statement executed. If the block is <tt>nil</tt>, any existing
tracer will be uninstalled.
</p>
        </div>
      </div>

      <div id="method-M000120" class="method-detail">
        <a name="M000120"></a>

        <div class="method-heading">
          <a href="Database.src/M000120.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000120.html');return false;">
          <span class="method-name">transaction</span><span class="method-args">( mode = :deferred ) {|self| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Begins a <a href="Database.html#M000095">new</a> <a
href="Database.html#M000120">transaction</a>. Note that nested transactions
are not allowed by SQLite, so attempting to nest a <a
href="Database.html#M000120">transaction</a> will result in a runtime
exception.
</p>
<p>
The <tt>mode</tt> parameter may be either <tt>:deferred</tt> (the default),
<tt>:immediate</tt>, or <tt>:exclusive</tt>.
</p>
<p>
If a block is given, the database instance is yielded to it, and the <a
href="Database.html#M000120">transaction</a> is committed when the block
terminates. If the block raises an exception, a <a
href="Database.html#M000122">rollback</a> will be performed instead. Note
that if a block is given, <a href="Database.html#M000121">commit</a> and <a
href="Database.html#M000122">rollback</a> should never be called explicitly
or you&#8216;ll get an error when the block terminates.
</p>
<p>
If a block is not given, it is the caller&#8216;s responsibility to end the
<a href="Database.html#M000120">transaction</a> explicitly, either by
calling <a href="Database.html#M000121">commit</a>, or by calling <a
href="Database.html#M000122">rollback</a>.
</p>
        </div>
      </div>

      <div id="method-M000123" class="method-detail">
        <a name="M000123"></a>

        <div class="method-heading">
          <a href="Database.src/M000123.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000123.html');return false;">
          <span class="method-name">transaction_active?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns <tt>true</tt> if there is a <a
href="Database.html#M000120">transaction</a> active, and <tt>false</tt>
otherwise.
</p>
        </div>
      </div>

      <div id="method-M000099" class="method-detail">
        <a name="M000099"></a>

        <div class="method-heading">
          <a href="Database.src/M000099.html" target="Code" class="method-signature"
            onclick="popupCode('Database.src/M000099.html');return false;">
          <span class="method-name">translator</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return the type <a href="Database.html#M000099">translator</a> employed by
this database instance. Each database instance has its own type <a
href="Database.html#M000099">translator</a>; this allows for different type
handlers to be installed in each instance without affecting other
instances. Furthermore, the translators are instantiated lazily, so that if
a database does not use type translation, it will not be burdened by the
overhead of a useless type <a href="Database.html#M000099">translator</a>.
(See the <a href="Translator.html">Translator</a> class.)
</p>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>